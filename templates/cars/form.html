{% extends 'base.html' %}
{% block title %}{{ title }}{% endblock %}
{% block content %}
<h3 class="mb-3">{{ title }}</h3>

<form method="post" enctype="multipart/form-data" class="card p-4 shadow-sm bg-dark text-light">
  {{ form.csrf_token }}
  <div class="row g-3">

    <div class="col-md-4">
      {{ form.vin.label(class="form-label") }}
      {{ form.vin(class='form-control bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-4">
      {{ form.brand.label(class="form-label") }}
      {{ form.brand(class='form-control bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-4">
      {{ form.model.label(class="form-label") }}
      {{ form.model(class='form-control bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-2">
      {{ form.year.label(class="form-label") }}
      {{ form.year(class='form-control bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-2">
      {{ form.color.label(class="form-label") }}
      {{ form.color(class='form-control bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-3">
      {{ form.price.label(class="form-label") }}
      {{ form.price(class='form-control bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-3">
      {{ form.currency.label(class="form-label") }}
      {{ form.currency(class='form-select bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-3">
      {{ form.status.label(class="form-label") }}
      {{ form.status(class='form-select bg-body-secondary text-light border-0') }}
    </div>

    <div class="col-md-6">
      {{ form.image_url.label(class="form-label") }}
      {{ form.image_url(class='form-control bg-body-secondary text-light border-0', placeholder='https://...') }}
      <small class="form-text text-secondary">Можно оставить пустым, если загружаете файл вручную.</small>
    </div>

    <div class="col-md-6">
      {{ form.image_file.label(class="form-label") }}
      {{ form.image_file(class='form-control bg-body-secondary text-light border-0') }}
      <small class="form-text text-secondary">Поддерживаемые форматы: JPG, PNG, GIF, WEBP. Размер до 5 МБ.</small>
    </div>

    <div class="col-md-12">
      {{ form.description.label(class="form-label") }}
      {{ form.description(class='form-control bg-body-secondary text-light border-0', rows=4) }}
    </div>

    {% if form._obj and form._obj.image_path %}
      <div class="col-12 mt-3">
        <span class="text-muted">Текущее фото:</span><br>
        <img src="{{ url_for('static', filename='uploads/' ~ form._obj.image_path) }}"
             alt="Текущее фото"
             style="height:140px;border-radius:10px;border:1px solid #333;object-fit:cover;margin-top:5px;">
      </div>
    {% elif form._obj and form._obj.image_url %}
      <div class="col-12 mt-3">
        <span class="text-muted">Текущее фото (URL):</span><br>
        <img src="{{ form._obj.image_url }}"
             alt="Текущее фото"
             style="height:140px;border-radius:10px;border:1px solid #333;object-fit:cover;margin-top:5px;">
      </div>
    {% endif %}
  </div>

  <div class="mt-4 d-flex gap-2">
    {{ form.submit(class='btn btn-danger px-4') }}
    <a href="{{ url_for('cars.my') }}" class="btn btn-outline-light px-4">Отмена</a>
  </div>
</form>
{% endblock %}
